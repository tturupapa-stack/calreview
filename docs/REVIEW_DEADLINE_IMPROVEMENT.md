# 리뷰 작성 기간 추출 정확도 개선 방안

## 현재 상황

### 리뷰 기간 추출 현황
- **리뷰노트**: 목록 페이지 JSON에서 `reviewEndAt - applyEndAt` 계산 (정확도 높음)
- **디너의여왕**: 상세 페이지 크롤링으로 추출 (느림, 타임아웃 위험)
- **강남맛집**: 상세 페이지 크롤링 가능하지만 현재 미사용
- **리뷰플레이스**: 상세 페이지 크롤링 가능하지만 현재 미사용
- **서울오빠, 모두의체험단, 파블로**: 상세 페이지 크롤링 가능하지만 현재 미사용

### 문제점
1. **디너의여왕**: 각 캠페인마다 상세 페이지 크롤링으로 인한 속도 저하
2. **대부분 사이트**: 리뷰 기간이 `None`으로 저장됨
3. **정확도**: 상세 페이지 크롤링 실패 시 리뷰 기간 정보 손실

## 개선 방안

### 1. 목록 페이지에서 리뷰 기간 추출 시도 (우선순위 높음)

각 사이트의 목록 페이지 HTML을 분석하여 리뷰 기간 정보가 있는지 확인:

#### 디너의여왕
- 목록 페이지 카드에서 리뷰 기간 정보 확인
- 예: "리뷰 기간: 14일", "D+14" 등의 패턴

#### 강남맛집
- 목록 페이지에서 리뷰 기간 정보 확인
- 상세 페이지 크롤링 대신 목록에서 추출 시도

#### 리뷰플레이스
- 목록 페이지에서 리뷰 기간 정보 확인

### 2. 상세 페이지 크롤링 최적화 (우선순위 중간)

목록에서 추출 불가능한 경우에만 상세 페이지 크롤링:

#### 배치 처리
- 모든 캠페인 수집 후, 리뷰 기간이 없는 캠페인만 상세 페이지 크롤링
- 병렬 처리로 속도 개선

#### 캐싱
- 이미 크롤링한 상세 페이지 정보 캐싱
- 동일 URL 재크롤링 방지

### 3. 정확도 개선 (우선순위 높음)

#### 날짜 파싱 개선
- 다양한 날짜 형식 지원
- 연도 경계 처리 개선 (예: 12.30 ~ 01.15)
- 타임존 처리

#### 검증 로직 추가
- 추출된 리뷰 기간이 합리적인 범위인지 확인 (예: 1일 ~ 90일)
- 이상치 필터링

### 4. 에러 처리 개선

#### 로깅 강화
- 리뷰 기간 추출 실패 시 상세 로그
- 실패한 URL 기록

#### 재시도 로직
- 네트워크 오류 시 재시도
- 타임아웃 증가 (현재 30초)

## 구현 계획

### Phase 1: 목록 페이지에서 리뷰 기간 추출
1. 각 사이트 목록 페이지 HTML 분석
2. 리뷰 기간 정보 패턴 파악
3. 목록 페이지에서 추출 로직 구현

### Phase 2: 상세 페이지 크롤링 최적화
1. 배치 처리 구현
2. 병렬 처리 추가
3. 캐싱 메커니즘 구현

### Phase 3: 정확도 개선
1. 날짜 파싱 로직 개선
2. 검증 로직 추가
3. 에러 처리 개선

## 예상 효과

- **속도**: 디너의여왕 크롤링 시간 50% 이상 단축
- **정확도**: 리뷰 기간 추출 성공률 80% 이상 달성
- **데이터 품질**: 모든 사이트에서 리뷰 기간 정보 제공
