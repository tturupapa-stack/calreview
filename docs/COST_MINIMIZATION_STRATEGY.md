# Phase 1 비용 최소화 전략

> **작성일**: 2024-12-19  
> **목적**: Phase 1에서 완전 무료 운영을 위한 전략 문서

## 🎯 핵심 원칙

**Phase 1 목표: 완전 무료 운영 ($0/월)**

- 수익화 전까지 비용 발생 방지
- Vercel 무료 플랜 내에서 모든 기능 제공
- 별도 서버 인프라 사용 안 함
- 자동 스케줄러는 Phase 2로 연기

## 💰 Phase 1 비용 분석 (전체 서비스 종합)

### 예상 비용: **월 $0 (완전 무료)**

| 서비스 | 플랜 | 무료 플랜 한도 | Phase 1 예상 사용량 | 사용률 | 비용 |
|--------|------|---------------|-------------------|--------|------|
| **Vercel** | 무료 | 100GB-hours/월 | 6.7시간/월 | 6.7% | $0 |
| **Supabase** | 무료 | 500MB DB, 5GB egress, 50,000 MAU | 300MB DB, 2GB egress, 5,000 MAU | 60%, 40%, 10% | $0 |
| **Google Calendar API** | 무료 | 할당량 내 (무제한) | 일 100회 이벤트 생성 | <1% | $0 |
| **GitHub Actions** | 무료 | Public: 무제한, Private: 2,000분/월 | 일 2회 × 30분 = 60분/월 | 3% | $0 |
| **Google OAuth** | 무료 | 무제한 | 일 50회 로그인 | - | $0 |
| **Naver OAuth** | 무료 | 무제한 | 일 50회 로그인 | - | $0 |
| **Resend** | 무료 | 3,000건/월 | Phase 1 미사용 | 0% | $0 |
| **총계** | - | - | - | - | **$0** |

### 서비스별 상세 사용량 분석

#### 1. Vercel 함수 실행 시간

**예상 사용량 (MAU 5,000명 기준):**
- 크롤러 API 호출: 일 100회 × 3초 = 300초/일 = 2.5시간/월
- 검색 API 호출: 일 500회 × 0.5초 = 250초/일 = 2.1시간/월
- 신청/북마크 API: 일 200회 × 0.3초 = 60초/일 = 0.5시간/월
- 캘린더 연동 API: 일 50회 × 1초 = 50초/일 = 0.4시간/월
- 기타 API: 일 200회 × 0.2초 = 40초/일 = 0.3시간/월
- **총 사용량: 5.8시간/월**
- **무료 플랜 한도: 100GB-hours/월**
- **사용률: 약 5.8% (여유 있음)**

#### 2. Supabase 데이터베이스

**예상 사용량 (MAU 5,000명 기준):**
- **데이터베이스 크기:**
  - 캠페인 데이터: 400개 × 5KB = 2MB
  - 사용자 데이터: 5,000명 × 2KB = 10MB
  - 신청 데이터: 10,000건 × 1KB = 10MB
  - 검색 기록: 50,000건 × 0.5KB = 25MB
  - 기타 데이터: 50MB
  - **총 예상 크기: 약 100MB**
  - **무료 플랜 한도: 500MB**
  - **사용률: 약 20% (여유 있음)**

- **대역폭 (Egress):**
  - 검색 API 응답: 일 500회 × 50KB = 25MB/일 = 750MB/월
  - 신청 목록 조회: 일 200회 × 30KB = 6MB/일 = 180MB/월
  - 캠페인 상세: 일 300회 × 20KB = 6MB/일 = 180MB/월
  - 기타: 200MB/월
  - **총 예상 대역폭: 약 1.3GB/월**
  - **무료 플랜 한도: 5GB/월**
  - **사용률: 약 26% (여유 있음)**

- **MAU (Monthly Active Users):**
  - **예상 MAU: 5,000명**
  - **무료 플랜 한도: 50,000 MAU**
  - **사용률: 10% (여유 있음)**

#### 3. Google Calendar API

**예상 사용량:**
- 이벤트 생성: 일 50회
- 이벤트 조회: 일 100회
- 이벤트 업데이트: 일 20회
- 이벤트 삭제: 일 10회
- **총 API 호출: 일 180회 = 월 5,400회**
- **할당량: 무제한 (비용 없음)**
- **비용: $0**

#### 4. GitHub Actions

**예상 사용량:**
- 크롤러 실행: 일 2회 × 30분 = 60분/일 = 1,800분/월
- **무료 플랜 한도 (Private): 2,000분/월**
- **사용률: 90% (주의 필요)**
- **대응**: Public repository로 전환하거나 크롤러 실행 시간 최적화

#### 5. Google OAuth / Naver OAuth

**예상 사용량:**
- 로그인: 일 50회 × 2 = 100회/일 = 3,000회/월
- **할당량: 무제한**
- **비용: $0**

#### 6. Resend (이메일)

**예상 사용량:**
- Phase 1에서는 미사용
- **무료 플랜 한도: 3,000건/월**
- **사용률: 0%**

## 🔧 기술 스택 변경 (비용 최소화)

### 변경 전 (v3.0)
- Python 크롤러 + 별도 서버 (Railway/Render)
- 비용: 월 $5-20

### 변경 후 (v3.1)
- Node.js + Cheerio (Vercel에서 직접 실행)
- 비용: 월 $0

### 구현 방법

**기존 계획:**
```python
# 별도 서버에서 Python 크롤러 실행
# Railway/Render 서버 필요 ($5-20/월)
```

**새로운 계획:**
```typescript
// Vercel API Route에서 직접 크롤링
// Cheerio로 HTML 파싱
// 비용: $0
```

## 📊 비용 모니터링 계획

### 1. Vercel 대시보드 모니터링
- 함수 실행 시간 추적
- 무료 플랜 한도 80% 도달 시 알림 설정
- 주간 사용량 리포트 생성

### 2. Supabase 대시보드 모니터링
- 데이터베이스 크기 추적
- 대역폭 사용량 추적
- 무료 플랜 한도 80% 도달 시 알림 설정

### 3. 사용량 알림 설정
- **Vercel**: 80GB-hours 사용 시 알림
- **Supabase**: 
  - 데이터베이스: 400MB 사용 시 알림
  - 대역폭: 4GB 사용 시 알림
  - MAU: 40,000명 사용 시 알림
- **GitHub Actions**: 1,600분 사용 시 알림 (Private repo인 경우)

## ⚠️ 비용 관련 리스크 및 대응

### 리스크 1: Vercel 무료 플랜 한도 초과

**위험:**
- 함수 실행 시간이 100GB-hours/월 초과 시 Pro 플랜 필요 ($20/월)

**대응:**
1. 사용량 모니터링 필수
2. 함수 실행 시간 최적화
   - 캐싱 활용
   - 배치 처리
   - 불필요한 함수 호출 제거
3. 무료 플랜 한도 80% 도달 시 알림
4. 한도 초과 시:
   - 기능 제한 (예: 크롤링 빈도 제한)
   - 또는 Phase 2로 연기
   - 또는 Vercel Pro 고려 (수익화 후)

### 리스크 2: Supabase 무료 플랜 한도 초과

**위험:**
- 데이터베이스 크기 초과 시: Pro 플랜 필요 ($25/월)
- 대역폭 초과 시: $0.09/GB 추가 비용
- MAU 초과 시: $0.00325/MAU 추가 비용

**대응:**
1. 사용량 모니터링 필수
2. 데이터 최적화
   - 불필요한 데이터 삭제
   - 오래된 검색 기록 정리 (30일 이상)
   - 인덱스 최적화
   - 페이지네이션 활용 (대역폭 절감)
3. 무료 플랜 한도 80% 도달 시 알림
   - 데이터베이스: 400MB 사용 시 알림
   - 대역폭: 4GB 사용 시 알림
   - MAU: 40,000명 사용 시 알림

### 리스크 4: GitHub Actions 무료 플랜 한도 초과

**위험:**
- Private repository에서 2,000분/월 초과 시 추가 비용 발생
- Linux: $0.008/분
- Windows: $0.016/분
- macOS: $0.08/분

**대응:**
1. **Public repository로 전환 (권장)**
   - Public repository는 무제한 무료
   - 크롤러 코드는 공개해도 문제없음
   - **비용: $0**

2. **크롤러 실행 시간 최적화**
   - 불필요한 사이트 크롤링 제거
   - 병렬 처리 최적화
   - 캐싱 활용

3. **크롤러 실행 빈도 조정**
   - 일 2회 → 일 1회로 감소 (필요 시)
   - 또는 주 3회로 조정

4. **무료 플랜 한도 80% 도달 시 알림**
   - 1,600분 사용 시 알림

### 리스크 3: 예상치 못한 트래픽 급증

**위험:**
- 갑작스러운 사용자 증가로 인한 비용 발생
- 바이럴 효과로 인한 사용량 급증

**대응:**
1. **Rate Limiting 설정**
   - Vercel: 함수별 Rate Limiting
   - Supabase: API Rate Limiting
   - 사용자당 일일 크롤링 횟수 제한

2. **사용량 모니터링 및 알림**
   - 실시간 사용량 대시보드
   - 급증 감지 알림

3. **필요 시 기능 제한**
   - 크롤링 빈도 제한 (사용자당 일 10회)
   - API 호출 제한 (사용자당 일 100회)
   - 검색 결과 캐싱 (대역폭 절감)

4. **비상 계획**
   - 사용량 급증 시 일시적 기능 제한
   - 사용자에게 안내 메시지 표시

## 🚀 Phase 2 이후 비용 고려사항

### 수익화 후 고려 가능한 비용

**성장 후 (MAU 5,000명 이상):**
- Vercel Pro: $20/월
- Supabase Pro: $25/월
- **총 비용: 월 $45-50**

**고려 시점:**
- 수익화 시작 후
- 무료 플랜 한도 초과 시
- 사용자 경험 저하 방지를 위해 필요 시

## 📋 체크리스트

### Phase 1 시작 전
- [ ] Vercel 무료 플랜 확인
- [ ] Supabase 무료 플랜 확인
- [ ] GitHub Actions: Public repository로 전환 검토 (무제한 무료)
- [ ] Google Calendar API 할당량 확인
- [ ] 사용량 모니터링 설정
- [ ] 알림 설정 (80% 도달 시)

### Phase 1 진행 중
- [ ] 주간 사용량 리포트 확인
  - Vercel 함수 실행 시간
  - Supabase 데이터베이스 크기 및 대역폭
  - GitHub Actions 실행 시간 (Private repo인 경우)
- [ ] 함수 실행 시간 최적화
- [ ] 데이터베이스 크기 모니터링
- [ ] 대역폭 사용량 모니터링
- [ ] MAU 추적
- [ ] 비용 발생 여부 확인 (월 $0 유지)

### Phase 1 완료 후
- [ ] 최종 비용 리포트 작성
- [ ] Phase 2 비용 계획 수립
- [ ] 수익화 전략 검토

## 💡 최적화 팁

### 함수 실행 시간 최적화
1. **캐싱 활용**
   - 동일한 크롤링 요청 결과 캐싱
   - Redis 또는 메모리 캐시 사용

2. **배치 처리**
   - 여러 요청을 한 번에 처리
   - 불필요한 함수 호출 제거

3. **코드 최적화**
   - 불필요한 로직 제거
   - 비동기 처리 최적화

### 데이터베이스 최적화
1. **데이터 정리**
   - 오래된 검색 기록 삭제 (30일 이상)
   - 불필요한 데이터 제거
   - 만료된 캠페인 정리

2. **인덱스 최적화**
   - 쿼리 성능 향상
   - 대역폭 사용량 감소
   - 자주 사용하는 쿼리에 인덱스 추가

3. **쿼리 최적화**
   - 필요한 데이터만 조회 (select 필드 최소화)
   - 페이지네이션 활용 (limit, offset)
   - JOIN 최적화
   - 불필요한 count 쿼리 제거

4. **대역폭 절감**
   - 검색 결과 캐싱 (같은 쿼리 재사용)
   - 이미지 최적화 (CDN 활용)
   - 응답 데이터 압축

### GitHub Actions 최적화
1. **Public Repository 전환 (최우선)**
   - Public repository는 무제한 무료
   - 크롤러 코드는 공개해도 문제없음

2. **크롤러 실행 시간 최적화**
   - 불필요한 사이트 크롤링 제거
   - 병렬 처리 최적화
   - 실패한 크롤링 재시도 최소화

3. **크롤러 실행 빈도 조정**
   - 일 2회 → 일 1회 (필요 시)
   - 또는 주 3회로 조정

## 📝 요약

**Phase 1 비용 전략:**
- ✅ 완전 무료 운영 ($0/월)
- ✅ Vercel 무료 플랜 활용
- ✅ Supabase 무료 플랜 활용
- ✅ 비용 모니터링 필수
- ✅ 한도 초과 시 대응 계획 수립

**핵심 메시지:**
> Phase 1에서는 수익화 전까지 비용을 발생시키지 않고, 무료 플랜 내에서 모든 기능을 제공합니다. 비용이 발생하면 프로젝트 지속가능성과 리스크가 커지므로, 철저한 모니터링과 최적화가 필수입니다.

## 📊 서비스별 상세 분석

### 1. Vercel
- **무료 플랜 한도**: 100GB-hours/월
- **예상 사용량**: 5.8시간/월
- **사용률**: 5.8%
- **리스크**: 낮음 (여유 있음)
- **대응**: 모니터링 및 최적화

### 2. Supabase
- **무료 플랜 한도**: 
  - 데이터베이스: 500MB
  - 대역폭: 5GB/월
  - MAU: 50,000명
- **예상 사용량**: 
  - 데이터베이스: 100MB (20%)
  - 대역폭: 1.3GB (26%)
  - MAU: 5,000명 (10%)
- **리스크**: 낮음 (여유 있음)
- **대응**: 데이터 정리, 쿼리 최적화

### 3. Google Calendar API
- **할당량**: 무제한 (비용 없음)
- **예상 사용량**: 월 5,400회
- **리스크**: 없음
- **대응**: 불필요

### 4. GitHub Actions
- **무료 플랜 한도**: 
  - Public: 무제한
  - Private: 2,000분/월
- **예상 사용량**: 1,800분/월 (Private 기준)
- **사용률**: 90% (주의 필요)
- **리스크**: 중간 (Private repo인 경우)
- **대응**: **Public repository로 전환 권장** (무제한 무료)

### 5. Google OAuth / Naver OAuth
- **할당량**: 무제한
- **예상 사용량**: 월 3,000회
- **리스크**: 없음
- **대응**: 불필요

### 6. Resend
- **무료 플랜 한도**: 3,000건/월
- **예상 사용량**: 0건 (Phase 1 미사용)
- **리스크**: 없음
- **대응**: 불필요
